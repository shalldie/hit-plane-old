!function(t){function e(h){if(i[h])return i[h].exports;var s=i[h]={exports:{},id:h,loaded:!1};return t[h].call(s.exports,s,s.exports,e),s.loaded=!0,s.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){"use strict";var h=i(6),s=document.getElementById("bg"),n=document.getElementById("demo");n.height=2*document.body.clientHeight,n.width=512*n.height/768,n.style.cssText="transform:translate3d(-50%,-50%,0) scale(.5)",s.style.width=n.width/2+"px",s.style.height=n.height+"px";var a=n.getContext("2d"),o=!navigator.userAgent.match(/(iPhone|iPod|Android|ios)/i),r=new h["default"](n.width,n.height,a,(!o));if(r.start(),o)n.addEventListener("mousemove",function(t){r.setPosition(t.offsetX,t.offsetY)});else{var l={x:0,y:0};n.addEventListener("touchstart",function(t){var e=t.touches[0];l={x:e.clientX,y:e.clientY}}),n.addEventListener("touchmove",function(t){var e=t.touches[0];r.offsetPosition(2*(e.clientX-l.x),2*(e.clientY-l.y)),l={x:e.clientX,y:e.clientY},t.preventDefault(),t.cancelBubble=!0})}},function(t,e){"use strict";function i(t,e,i,s,n,a,o,r,l,c,u,p){if(void 0===u&&(u=1),a<=1)return h(t,e,0,0,e.width,e.height,o,r,l,c),void(p&&p());var d=+new Date-+s;d%=i*a;var g=~~(d/i),f=n?g*e.width/a:0,m=n?0:g*e.height/a,y=n?e.width/a:e.width,v=n?e.height:e.height/a;t.save(),t.globalAlpha=u,t.drawImage(e,~~f,~~m,~~y,~~v,o,r,l,c),t.restore(),g+1>=a&&p&&p()}function h(t,e,i,h,s,n,a,o,r,l,c){void 0===i&&(i=0),void 0===h&&(h=0),void 0===s&&(s=e.width),void 0===n&&(n=e.height),void 0===a&&(a=0),void 0===o&&(o=0),void 0===r&&(r=e.width),void 0===l&&(l=e.height),void 0===c&&(c=1),1==c?t.drawImage(e,i,h,s,n,a,o,r,l):(t.save(),t.globalAlpha=c,t.drawImage(e,i,h,s,n,a,o,r,l),t.restore())}function s(t,e,i,h,s,n,a,o,r,l,c){void 0===i&&(i=0),void 0===h&&(h=0),void 0===s&&(s=e.width),void 0===n&&(n=e.height),void 0===a&&(a=0),void 0===o&&(o=0),void 0===r&&(r=e.width),void 0===l&&(l=e.height),void 0===c&&(c=1),1==c?t.drawImage(e,i,h,s,n,a,o,r,l):(t.save(),t.globalAlpha=c,t.drawImage(e,i,h,s,n,a,o,r,l),t.restore())}function n(t,e){return!(t.x+t.realWidth/2<e.x-e.realWidth/2||t.y+t.realHeight/2<e.y-e.realHeight/2||e.x+e.realWidth/2<t.x-t.realWidth/2||e.y+e.realHeight/2<t.y-t.realHeight/2)}function a(t,e){return e?void setInterval(t,e):(t(),void requestAnimationFrame(function(){a(t)}))}e.imgSpirit=i,e.imgDrawSingle=h,e.canvasDrawSingle=s,e.ifIntersect=n,e.makeRequestAnimationFrame=a},function(t,e){"use strict";var i=window.hitplane_source;e.imgPlane=i.plane,e.imgBoom=i.boom,e.imgBulletArr=[i.bullet01,i.bullet02,i.bullet03,i.enemy_bullet],e.imgHP=i.hp,e.imgEnemy=i.enemy,e.imgHeart=i.heart},function(t,e,i){"use strict";var h=i(1),s=function(){function t(t,e,i,h,s){this.alive=!0,this.createTime=new Date,this.ifImgX=!0,this.imgSum=1,this.opacity=1,this.x=t,this.y=e,this.width=i,this.height=h,this.realWidth=i*s,this.realHeight=h*s,this.scale=s}return Object.defineProperty(t.prototype,"x",{get:function(){return this._x},set:function(t){this._x=~~t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},set:function(t){this._y=~~t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this._width},set:function(t){this._width=~~t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},set:function(t){this._height=~~t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"realWidth",{get:function(){return this._realWidth},set:function(t){this._realWidth=~~t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"realHeight",{get:function(){return this._realHeight},set:function(t){this._realHeight=~~t},enumerable:!0,configurable:!0}),t.prototype.makeOpacity=function(t,e){this.opacity=t,this.opacityTime=new Date,this.opacityLast=e},t.prototype.onPaint=function(t){if(this.alive){var e=1;1!=this.opacity&&(new Date).getTime()-this.opacityTime.getTime()<this.opacityLast&&(e=this.opacity),h.imgSpirit(t,this.img,this.colourSpeed,this.createTime,this.ifImgX,this.imgSum,this.x-this.width/2,this.y-this.height/2,this.width,this.height,e)}},t}();Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=s},function(t,e,i){"use strict";var h=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var h in e)e.hasOwnProperty(h)&&(t[h]=e[h]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},s=i(3),n=i(2),a=i(1),o=function(t){function e(e,i,h,s,n,a){void 0===n&&(n=0),void 0===a&&(a=1),t.call(this,e,i,h,s,a),this.typeIndex=0,this.ATK=10,this.speedSpan=.34,this.resetBullet(e,i,h,s,n,a),this.makeCache()}return h(e,t),e.prototype.makeCache=function(){this.cacheCanvas=document.createElement("canvas"),this.cacheCanvas.width=this.realWidth,this.cacheCanvas.height=this.realHeight;var t=this.cacheCanvas.getContext("2d");t.drawImage(this.img,0,0,this.img.width,this.img.height,0,0,this.cacheCanvas.width,this.cacheCanvas.height)},e.prototype.resetBullet=function(t,e,i,h,s,a){void 0===s&&(s=0),void 0===a&&(a=1),this.x=t,this.y=e,this.width=i,this.height=h,this.img=n.imgBulletArr[s],this.baseY=e,this.speedSpan=.34/a,this.speedSpan=(.34+.12*s)/a,this.typeIndex=s,this.alive=!0,this.createTime=new Date},e.prototype.onPaint=function(t){var e=(new Date).getTime()-this.createTime.getTime();this.y=this.baseY-~~(e/this.speedSpan),t.drawImage(this.cacheCanvas,this.x-this.realWidth/2,this.y-this.realHeight/2)},e}(s["default"]);e.Bullet=o;var r=function(t){function e(e,i,h,s){void 0===s&&(s=1),t.call(this,e,i,h,h,3,s),this.speedSpan=3/s}return h(e,t),e.prototype.onPaint=function(t){var e=(new Date).getTime()-this.createTime.getTime();this.y=this.baseY+~~(e/this.speedSpan),a.imgSpirit(t,this.img,300,this.createTime,!0,3,this.x-this.width*this.scale/2,this.y-this.height*this.scale/2,this.width*this.scale,this.height*this.scale)},e}(o);e.EnemyBullet=r},function(t,e){"use strict";!function(t){t[t.Normal=0]="Normal",t[t.Shake=1]="Shake",t[t.Crooked=2]="Crooked",t[t.Boss=3]="Boss"}(e.BehaveType||(e.BehaveType={}));var i=(e.BehaveType,function(){function t(){this.behaveType=0}return t.prototype.behave=function(t,e,i){void 0===i&&(i=1);var h=[this.getNormalBehave];h[this.behaveType](t,e,i)},t.prototype.getNormalBehave=function(t,e,i){void 0===i&&(i=1);var h=e.getTime()-t.createTime.getTime();t.y=t.baseY+h*t.speed*i},t.prototype.getShakeBehave=function(t,e){},t}());Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=i},function(t,e,i){"use strict";var h=i(1),s=i(7),n=i(8),a=i(9),o=function(){function t(t,e,i,h){this.enemyList=[],this.enemyBulletList=[],this.bulletList=[],this.boomList=[],this.scale=1,this.tag=1,this.width=t,this.height=e,this.ctx=i,this.scale=this.height/1200,h&&(this.scale*=1.3)}return t.prototype.start=function(){this.newPlane(),setInterval(function(){this.newEnemy()}.bind(this),1500),this.keepRefresh()},t.prototype.setPosition=function(t,e){this.plane.x=t,this.plane.y=e},t.prototype.offsetPosition=function(t,e){this.plane.x+=t,this.plane.y+=e},t.prototype.newPlane=function(){this.plane=new a["default"](this.width/2,0,172,200,this.scale),this.plane.y=this.height-this.plane.height*this.scale,this.plane.makeOpacity(.5,3e3);var t=setInterval(function(){this.plane.fire([[0,0],[1,1],[1,2],[2,1],[2,2]],this.bulletList),this.plane.alive||clearInterval(t)}.bind(this),110)},t.prototype.newEnemy=function(){var t=this.width/10*~~(10*Math.random()+1),e=80+80*Math.random(),i=~~(4*Math.random()),h=new n["default"](t,-t/2,e,i,100,this.scale);if(h.x+h.width/2>this.width||h.x<h.width/2)return void this.newEnemy();h.resetY(-h.height/2),h.speed*=Math.random()+1,this.enemyList.push(h);var s=this,a=setInterval(function(){return h.alive?void(s.enemyBulletList=s.enemyBulletList.concat(h.fire())):void clearInterval(a)},800+500*Math.random())},t.prototype.newBoom=function(t,e,i){var h=new s["default"](t,e,i,i,this.scale);this.boomList.push(h)},t.prototype.keepRefresh=function(){var t=this;h.makeRequestAnimationFrame(function(){t.onPaint(),t.tag++,t.tag>1e3&&(t.tag=0),t.tag%2==0&&t.checkIntersectAndOut(),t.tag%20==0&&t.onGC()},null)},t.prototype.checkIntersectAndOut=function(){var t,e,i,s=0,n=0,a=0,o=0,r=0;for(n=0,o=this.enemyList.length;n<o;n++)for(t=this.enemyList[n],a=0,r=this.bulletList.length;a<r;a++)e=this.bulletList[a],e.alive&&e.y+e.height<0&&(e.alive=!1),e.alive&&t.alive&&h.ifIntersect(t,e)&&(e.alive=!1,t.HP-=e.ATK,t.makeOpacity(.5,10),t.HP<=0&&(t.HP=0,t.alive=!1,this.newBoom(t.x,t.y,1.2*t.width)));for(s=0,o=this.enemyBulletList.length;s<o;s++)i=this.enemyBulletList[s],this.plane.alive&&h.ifIntersect(this.plane,i)&&(i.alive=!1,this.plane.makeOpacity(.5,2e3))},t.prototype.onGC=function(){var t=this;this.enemyBulletList=this.enemyBulletList.filter(function(e){return e.alive&&e.y-e.height<t.height}),this.boomList=this.boomList.filter(function(t){return t.alive}),this.enemyList=this.enemyList.filter(function(e){return e.alive&&e.y<e.height+t.height})},t.prototype.onPaint=function(){this.ctx.clearRect(0,0,this.width,this.height);var t,e,i,h,s=0,n=0;try{for(s=0,n=this.bulletList.length;s<n;s++)t=this.bulletList[s],t.alive&&t.onPaint(this.ctx);for(s=0,n=this.enemyBulletList.length;s<n;s++)e=this.enemyBulletList[s],e.alive&&e.onPaint(this.ctx);for(s=0,n=this.enemyList.length;s<n;s++)i=this.enemyList[s],i.alive&&i.onPaint(this.ctx);for(s=0,n=this.boomList.length;s<n;s++)h=this.boomList[s],h.alive&&h.onPaint(this.ctx);this.plane.onPaint(this.ctx)}catch(a){throw console.log(a),a}},t}();Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=o},function(t,e,i){"use strict";var h=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var h in e)e.hasOwnProperty(h)&&(t[h]=e[h]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},s=i(2),n=i(3),a=i(1),o=function(t){function e(e,i,h,n,a){t.call(this,e,i,h,n,a),this.img=s.imgBoom,this.imgSum=14,this.colourSpeed=40}return h(e,t),e.prototype.onPaint=function(t){var e=this;a.imgSpirit(t,this.img,this.colourSpeed,this.createTime,!0,14,this.x-this.width*this.scale/2,this.y-this.height*this.scale/2,this.width*this.scale,this.height*this.scale,1,function(){e.alive=!1})},e}(n["default"]);Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=o},function(t,e,i){"use strict";var h=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var h in e)e.hasOwnProperty(h)&&(t[h]=e[h]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},s=i(3),n=i(1),a=i(2),o=i(4),r=i(5),l=[{x:0,y:0,w:103,h:74},{x:121,y:0,w:97,h:75},{x:0,y:83,w:113,h:81},{x:118,y:88,w:100,h:76}];!function(t){t[t.Yello=0]="Yello",t[t.White=1]="White",t[t.Red=2]="Red",t[t.Green=3]="Green"}(e.EnemyType||(e.EnemyType={}));var c=(e.EnemyType,function(t){function e(e,i,h,s,n,o){var c=l[s],u=h*c.h/c.w;t.call(this,e,i,h,u,o),this.area=c,this.img=a.imgEnemy,this.HP=n,this.maxHP=n,this.baseX=e,this.baseY=i,this.ai=new r["default"],this.speed=.1,this.cacheImg()}return h(e,t),e.prototype.cacheImg=function(){this.cacheCanvas=document.createElement("canvas"),this.cacheCanvas.width=this.realWidth,this.cacheCanvas.height=this.realHeight;var t=this.cacheCanvas.getContext("2d");n.imgDrawSingle(t,this.img,this.area.x,this.area.y,this.area.w,this.area.h,0,0,this.realWidth,this.realHeight)},e.prototype.resetY=function(t){this.baseY=t,this.y=t},e.prototype.fire=function(){return[new o.EnemyBullet(this.x,this.y+this.height/2+2,this.width/2,this.scale)]},e.prototype.onPaint=function(t){if(this.cacheCanvas){var e=new Date;this.ai.behave(this,e,this.scale);var i=1;1!=this.opacity&&e.getTime()-this.opacityTime.getTime()<this.opacityLast&&(i=this.opacity),n.imgDrawSingle(t,a.imgHP,0,0,a.imgHP.width,a.imgHP.height,this.x-this.width*this.scale/2,this.y-this.height*this.scale/2-20*this.scale,this.width*this.scale*this.HP/this.maxHP,10*this.scale),1==i?t.drawImage(this.cacheCanvas,this.x-this.realWidth/2,this.y-this.realHeight/2):(t.save(),t.globalAlpha=i,t.drawImage(this.cacheCanvas,this.x-this.realWidth/2,this.y-this.realHeight/2),t.restore())}},e}(s["default"]));Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=c},function(t,e,i){"use strict";var h=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var h in e)e.hasOwnProperty(h)&&(t[h]=e[h]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},s=i(2),n=i(3),a=i(1),o=i(4),r=function(t){function e(e,i,h,n,a){t.call(this,e,i,h,n,a),this.img=s.imgPlane,this.imgSum=11,this.colourSpeed=50,this.realWidth=.5*h,this.realHeight=.5*n,this.maxHP=100,this.HP=this.maxHP}return h(e,t),e.prototype.fire=function(t,e){for(var i,h=0,s=t.length,n=0,a=e.length;n<a&&!(h>=s);n++)i=e[n],i.alive||i.typeIndex!=t[h][0]||(this.resetBullet(i,t[h][0],t[h][1]),h++);for(;h<s;)e.push(this.resetBullet(null,t[h][0],t[h][1])),h++},e.prototype.resetBullet=function(t,e,i){void 0===i&&(i=0);var h=[8,25,50],s=this.x+[0,-1,1][i]*h[e];return t?t.resetBullet(s,this.y-this.height/2,96,96,e,this.scale):t=new o.Bullet(s,this.y-this.height/2,96,96,e,this.scale),t},e.prototype.onPaint=function(t){if(this.alive){var e=1;1!=this.opacity&&(new Date).getTime()-this.opacityTime.getTime()<this.opacityLast?e=this.opacity:1!=this.opacity&&(e=1),a.imgSpirit(t,this.img,this.colourSpeed,this.createTime,this.ifImgX,this.imgSum,this.x-this.width*this.scale/2,this.y-this.height*this.scale/2,this.width*this.scale,this.height*this.scale,e)}},e}(n["default"]);Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=r}]);